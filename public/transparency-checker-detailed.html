<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Images Transparency Checker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .image-item {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: white;
        }
        .image-item.non-transparent {
            border-color: #dc3545;
            background: #fff5f5;
        }
        .image-item.transparent {
            border-color: #28a745;
            background: #f8fff8;
        }
        .image-name {
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        .test-backgrounds {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .bg-test {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 4px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .bg-white { background-color: white; border: 1px solid #ddd; }
        .bg-gray { background-color: #808080; }
        .bg-checkerboard {
            background-image: 
                linear-gradient(45deg, #ccc 25%, transparent 25%), 
                linear-gradient(-45deg, #ccc 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #ccc 75%), 
                linear-gradient(-45deg, transparent 75%, #ccc 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }
        .test-image {
            max-width: 100%;
            max-height: 100px;
            object-fit: contain;
        }
        .transparency-status {
            text-align: center;
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
            margin-top: 10px;
        }
        .transparent { background: #d4edda; color: #155724; }
        .non-transparent { background: #f8d7da; color: #721c24; }
        .analysis {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 8px;
        }
        h1 { text-align: center; color: #333; }
        h3 { color: #007bff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Medical Images Transparency Analysis</h1>
        <p style="text-align: center; color: #666;">
            This tool checks which medical images have transparent backgrounds vs solid backgrounds
        </p>
        
        <div class="image-grid" id="imageGrid">
            <!-- Images will be loaded here -->
        </div>
        
        <div class="analysis" id="analysis">
            <h3>Analysis Results:</h3>
            <div id="results"></div>
        </div>
    </div>

    <script>
        // List of all medical images to check
        const medicalImages = [
            'malefront.png',
            'maleback.png',
            'maleleftside.png',
            'malerightside.png',
            'malecardiorespi.png',
            'maleabdominallinguinal.png',
            'femalefront.png',
            'femaleback.png',
            'femaleleftside.png',
            'femalerightside.png',
            'femalecardiorespi.png',
            'femaleabdominallinguinal.png'
        ];

        let results = {
            transparent: [],
            nonTransparent: [],
            errors: []
        };

        function checkImageTransparency(imageSrc, imageName) {
            return new Promise((resolve) => {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    ctx.drawImage(img, 0, 0);
                    
                    try {
                        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        const data = imageData.data;
                        
                        let hasTransparency = false;
                        let transparentPixels = 0;
                        let totalPixels = canvas.width * canvas.height;
                        
                        // Check every 4th pixel (RGBA format) for alpha channel
                        for (let i = 3; i < data.length; i += 4) {
                            if (data[i] < 255) { // Alpha less than 255 means some transparency
                                hasTransparency = true;
                                if (data[i] === 0) transparentPixels++;
                            }
                        }
                        
                        const transparencyPercentage = (transparentPixels / totalPixels * 100).toFixed(1);
                        
                        resolve({
                            name: imageName,
                            hasTransparency,
                            transparencyPercentage,
                            dimensions: `${img.width} √ó ${img.height}`,
                            loaded: true
                        });
                    } catch (error) {
                        resolve({
                            name: imageName,
                            hasTransparency: false,
                            error: 'Cannot analyze - CORS or canvas error',
                            loaded: true
                        });
                    }
                };
                
                img.onerror = function() {
                    resolve({
                        name: imageName,
                        hasTransparency: false,
                        error: 'Image failed to load',
                        loaded: false
                    });
                };
                
                img.src = imageSrc;
            });
        }

        function createImageItem(imageName, result) {
            const item = document.createElement('div');
            item.className = `image-item ${result.hasTransparency ? 'transparent' : 'non-transparent'}`;
            
            const hasTransparency = result.hasTransparency;
            const statusClass = hasTransparency ? 'transparent' : 'non-transparent';
            const statusText = result.error ? `‚ùå ${result.error}` : 
                              hasTransparency ? `‚úÖ Transparent (${result.transparencyPercentage}% transparent pixels)` : 
                              '‚ùå No transparency detected';
            
            item.innerHTML = `
                <div class="image-name">${imageName}</div>
                <div class="test-backgrounds">
                    <div class="bg-test bg-white">
                        <img src="medical-images/${imageName}" alt="${imageName}" class="test-image" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div style="display:none; color: red;">Failed to load</div>
                    </div>
                    <div class="bg-test bg-gray">
                        <img src="medical-images/${imageName}" alt="${imageName}" class="test-image"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div style="display:none; color: red;">Failed to load</div>
                    </div>
                    <div class="bg-test bg-checkerboard">
                        <img src="medical-images/${imageName}" alt="${imageName}" class="test-image"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div style="display:none; color: red;">Failed to load</div>
                    </div>
                </div>
                <div class="transparency-status ${statusClass}">
                    ${statusText}
                    ${result.dimensions ? `<br><small>Size: ${result.dimensions}</small>` : ''}
                </div>
            `;
            
            return item;
        }

        async function checkAllImages() {
            const imageGrid = document.getElementById('imageGrid');
            const resultsDiv = document.getElementById('results');
            
            // Show loading message
            resultsDiv.innerHTML = '<p>üîÑ Analyzing images for transparency...</p>';
            
            for (const imageName of medicalImages) {
                const result = await checkImageTransparency(`medical-images/${imageName}`, imageName);
                
                if (result.error) {
                    results.errors.push(result);
                } else if (result.hasTransparency) {
                    results.transparent.push(result);
                } else {
                    results.nonTransparent.push(result);
                }
                
                const imageItem = createImageItem(imageName, result);
                imageGrid.appendChild(imageItem);
            }
            
            // Update analysis results
            const totalImages = medicalImages.length;
            const transparentCount = results.transparent.length;
            const nonTransparentCount = results.nonTransparent.length;
            const errorCount = results.errors.length;
            
            resultsDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="background: #d4edda; padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #155724;">${transparentCount}</div>
                        <div style="color: #155724;">Transparent Images</div>
                    </div>
                    <div style="background: #f8d7da; padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #721c24;">${nonTransparentCount}</div>
                        <div style="color: #721c24;">Non-Transparent Images</div>
                    </div>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #856404;">${errorCount}</div>
                        <div style="color: #856404;">Loading Errors</div>
                    </div>
                </div>
                
                ${nonTransparentCount > 0 ? `
                <div style="background: #f8d7da; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <h4 style="color: #721c24; margin-top: 0;">‚ö†Ô∏è Images Needing Transparency:</h4>
                    <ul style="color: #721c24;">
                        ${results.nonTransparent.map(img => `<li><strong>${img.name}</strong> - ${img.dimensions}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}
                
                <div style="background: #d1ecf1; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <h4 style="color: #0c5460; margin-top: 0;">üìã Summary:</h4>
                    <p style="color: #0c5460; margin: 0;">
                        <strong>${transparentCount}/${totalImages}</strong> images have proper transparency.
                        ${nonTransparentCount > 0 ? 
                            `The <strong>${results.nonTransparent.map(img => img.name).join(', ')}</strong> image${nonTransparentCount > 1 ? 's' : ''} still have solid backgrounds and should be processed for transparency.` 
                            : 'All images have transparent backgrounds! üéâ'
                        }
                    </p>
                </div>
            `;
        }

        // Start checking images when page loads
        document.addEventListener('DOMContentLoaded', checkAllImages);
    </script>
</body>
</html>
